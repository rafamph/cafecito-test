<html>
  <head>
    <title>basic video call events/control demo</title>
    <!-- this library, bundled and minimized -->
    <script src="https://unpkg.com/@daily-co/daily-js"></script>
    <!-- helper script to create a demo room under the api-demo.daily.co
     domain. replace this in your production code with a function
     that creates rooms within your own domain. -->
    <!-- <script src="../shared-assets/create-demo-room.js"></script> -->

  </head>
  <body>


    <script>
      function showEvent(e) {
        console.log("video call event -->", e);
      }

      function renderFeedbackPage(){
          location.href = "https://meetcafecito.com/#post-feedback";
      }

      async function run() {
        // create a short-lived demo room. if you just want to
        // hard-code a meeting link for testing you could do something like
        // this:
        //
        //   room = { url: 'https://cafecitotest2.daily.co/pache-colis' }
        //
        //room = await createMtgRoom();

        // create a video call iframe and add it to document.body
        // defaults to floating window in the lower right-hand corner
        //
        //window.callFrame = window.DailyIframe.createFrame();

        callFrame = window.DailyIframe.createFrame({
          iframeStyle: {
            position: 'fixed',
            border: 0,
            top: 1,
            left: 0,
            width: '100%',
            height: '100%',

          },
          showLeaveButton: true
        });
        callFrame.join({ url: 'https://cafecito.daily.co/cortado' });

        // install event handlers that just print out event information
        // to the console
        //
        callFrame
          .on("loading", showEvent)
          .on("loaded", showEvent)
          .on("started-camera", showEvent)
          .on("camera-error", showEvent)
          .on("joining-meeting", showEvent)
          .on("joined-meeting", showEvent)
          .on("participant-joined", showEvent)
          .on("participant-updated", showEvent)
          .on("participant-left", showEvent)
          .on("recording-started", showEvent)
          .on("recording-stopped", showEvent)
          .on("recording-stats", showEvent)
          .on("recording-error", showEvent)
          .on("recording-upload-completed", showEvent)
          .on("app-message", showEvent)
          .on("input-event", showEvent)
          .on("error", showEvent)
          // add a leave handler to clean things up
          .on("left-meeting", renderFeedbackPage);

        // join the room
        //
        await callFrame.join({
          url: room.url,
          showLeaveButton: true
        });

        function leave(e) {
          showEvent(e);
          callFrame.destroy();
        }

        console.log(
          " You are connected to",
          callFrame.properties.url,
          "\n",
          "Use the window.callFrame object to experiment with",
          "\n",
          "controlling this call. For example, in the console",
          "\n",
          "try",
          "\n",
          "    callFrame.participants()",
          "\n",
          "    callFrame.setLocalVideo(false)",
          "\n",
          "    callFrame.startScreenShare()"
        );
      }

      document.addEventListener("DOMContentLoaded", run());
    </script>
  </body>
</html>
